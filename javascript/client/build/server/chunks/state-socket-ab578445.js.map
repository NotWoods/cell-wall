{"version":3,"file":"state-socket-ab578445.js","sources":["../../../.svelte-kit/adapter-node/chunks/state-socket.js"],"sourcesContent":["import { b as blankState } from \"./web.js\";\nimport { r as readable } from \"./index2.js\";\nfunction connect(serial) {\n  {\n    return void 0;\n  }\n}\nfunction isCellState(state) {\n  return Boolean(state && typeof state === \"object\" && \"type\" in state);\n}\nfunction emptyData(data) {\n  if (data instanceof ArrayBuffer) {\n    return data.byteLength === 0;\n  } else if (data instanceof Blob) {\n    return data.size === 0;\n  }\n  return false;\n}\nfunction jsonParse(data) {\n  try {\n    return JSON.parse(data);\n  } catch (error) {\n    if (error instanceof SyntaxError) {\n      return void 0;\n    }\n    throw error;\n  }\n}\nfunction cellState(socket) {\n  let receivedState = blankState;\n  return readable(blankState, (set) => {\n    const controller = new AbortController();\n    function handleMessage({ data }) {\n      if (typeof data === \"string\") {\n        const maybeJson = jsonParse(data);\n        if (isCellState(maybeJson)) {\n          receivedState = maybeJson;\n          return;\n        }\n      }\n      if (!emptyData(data)) {\n        receivedState.payload = data;\n      }\n      set(receivedState);\n    }\n    socket?.addEventListener(\"message\", handleMessage, controller);\n    return () => controller.abort();\n  });\n}\nfunction frameUrl(type, serial) {\n  return `/cell/frame/${type.toLowerCase()}?id=${serial}`;\n}\nexport {\n  cellState as a,\n  connect as c,\n  frameUrl as f\n};\n"],"names":[],"mappings":";;;AAEA,SAAS,OAAO,CAAC,MAAM,EAAE;AACzB,EAAE;AACF,IAAI,OAAO,KAAK,CAAC,CAAC;AAClB,GAAG;AACH,CAAC;AACD,SAAS,WAAW,CAAC,KAAK,EAAE;AAC5B,EAAE,OAAO,OAAO,CAAC,KAAK,IAAI,OAAO,KAAK,KAAK,QAAQ,IAAI,MAAM,IAAI,KAAK,CAAC,CAAC;AACxE,CAAC;AACD,SAAS,SAAS,CAAC,IAAI,EAAE;AACzB,EAAE,IAAI,IAAI,YAAY,WAAW,EAAE;AACnC,IAAI,OAAO,IAAI,CAAC,UAAU,KAAK,CAAC,CAAC;AACjC,GAAG,MAAM,IAAI,IAAI,YAAY,IAAI,EAAE;AACnC,IAAI,OAAO,IAAI,CAAC,IAAI,KAAK,CAAC,CAAC;AAC3B,GAAG;AACH,EAAE,OAAO,KAAK,CAAC;AACf,CAAC;AACD,SAAS,SAAS,CAAC,IAAI,EAAE;AACzB,EAAE,IAAI;AACN,IAAI,OAAO,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;AAC5B,GAAG,CAAC,OAAO,KAAK,EAAE;AAClB,IAAI,IAAI,KAAK,YAAY,WAAW,EAAE;AACtC,MAAM,OAAO,KAAK,CAAC,CAAC;AACpB,KAAK;AACL,IAAI,MAAM,KAAK,CAAC;AAChB,GAAG;AACH,CAAC;AACD,SAAS,SAAS,CAAC,MAAM,EAAE;AAC3B,EAAE,IAAI,aAAa,GAAG,UAAU,CAAC;AACjC,EAAE,OAAO,QAAQ,CAAC,UAAU,EAAE,CAAC,GAAG,KAAK;AACvC,IAAI,MAAM,UAAU,GAAG,IAAI,eAAe,EAAE,CAAC;AAC7C,IAAI,SAAS,aAAa,CAAC,EAAE,IAAI,EAAE,EAAE;AACrC,MAAM,IAAI,OAAO,IAAI,KAAK,QAAQ,EAAE;AACpC,QAAQ,MAAM,SAAS,GAAG,SAAS,CAAC,IAAI,CAAC,CAAC;AAC1C,QAAQ,IAAI,WAAW,CAAC,SAAS,CAAC,EAAE;AACpC,UAAU,aAAa,GAAG,SAAS,CAAC;AACpC,UAAU,OAAO;AACjB,SAAS;AACT,OAAO;AACP,MAAM,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,EAAE;AAC5B,QAAQ,aAAa,CAAC,OAAO,GAAG,IAAI,CAAC;AACrC,OAAO;AACP,MAAM,GAAG,CAAC,aAAa,CAAC,CAAC;AACzB,KAAK;AACL,IAAI,MAAM,EAAE,gBAAgB,CAAC,SAAS,EAAE,aAAa,EAAE,UAAU,CAAC,CAAC;AACnE,IAAI,OAAO,MAAM,UAAU,CAAC,KAAK,EAAE,CAAC;AACpC,GAAG,CAAC,CAAC;AACL,CAAC;AACD,SAAS,QAAQ,CAAC,IAAI,EAAE,MAAM,EAAE;AAChC,EAAE,OAAO,CAAC,YAAY,EAAE,IAAI,CAAC,WAAW,EAAE,CAAC,IAAI,EAAE,MAAM,CAAC,CAAC,CAAC;AAC1D;;;;"}