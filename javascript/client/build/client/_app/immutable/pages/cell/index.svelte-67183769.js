var Z=Object.defineProperty,$=Object.defineProperties;var ee=Object.getOwnPropertyDescriptors;var C=Object.getOwnPropertySymbols;var V=Object.prototype.hasOwnProperty,W=Object.prototype.propertyIsEnumerable;var K=(t,s,a)=>s in t?Z(t,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[s]=a,T=(t,s)=>{for(var a in s||(s={}))V.call(s,a)&&K(t,a,s[a]);if(C)for(var a of C(s))W.call(s,a)&&K(t,a,s[a]);return t},A=(t,s)=>$(t,ee(s));var M=(t,s)=>{var a={};for(var e in t)V.call(t,e)&&s.indexOf(e)<0&&(a[e]=t[e]);if(t!=null&&C)for(var e of C(t))s.indexOf(e)<0&&W.call(t,e)&&(a[e]=t[e]);return a};import{S as te,i as se,s as ae,k as E,e as p,t as x,N as re,d,m as S,c as _,a as y,h as D,$ as ne,b as l,g as Y,M as o,a3 as j,Y as F,a4 as le,E as X,G as oe,v as ie}from"../../chunks/index-629ae59a.js";import{p as ce,f as z,g as ue}from"../../chunks/state-socket-b8e35e3e.js";import{d as H,w as de}from"../../chunks/index-6cd92273.js";import"../../chunks/web-75f832b0.js";import"../../chunks/singletons-d1fb5791.js";const fe=!0,me=new Set(["BLANK","TEXT","IMAGE","WEB","CLOCK","BUSY"]);function Q(){const t=de({active:!1});return{state:t,active:H(t,s=>s.active),error:H(t,s=>s.error)}}function ve(){const t=new AbortController,n=Q(),{state:s}=n,a=M(n,["state"]);async function e(){try{await document.documentElement.requestFullscreen().then(()=>s.set({active:!0}),i=>s.set({active:!1,error:i})),s.set({active:!0})}catch(i){if(i instanceof Error)s.set({active:!1,error:i});else throw i}}return e(),document.addEventListener("fullscreenchange",()=>{s.set({active:Boolean(document.fullscreenElement)})},t),A(T({},a),{async release(){t.abort(),await document.exitFullscreen()}})}function he(){if("wakeLock"in navigator){let s=function(){e!==null&&document.visibilityState==="visible"&&f()};const a=new AbortController;let e;const t=Q(),{state:n}=t,i=M(t,["state"]);async function f(){try{e=await navigator.wakeLock.request("screen"),n.set({active:!0}),e.addEventListener("release",()=>{n.set({active:!1})},a)}catch(r){if(r instanceof DOMException)n.set({active:!1,error:r});else throw r}}return f(),document.addEventListener("visibilitychange",s,a),document.addEventListener("fullscreenchange",s,a),A(T({},i),{async release(){a.abort(),await(e==null?void 0:e.release())}})}else return}function pe(t){let s,a,e,n,i,f,r,g,I,c,q,m,v,k,B,b,J,N,O;return{c(){s=E(),a=p("div"),e=p("form"),n=p("img"),f=E(),r=p("label"),g=x("Cell ID"),I=E(),c=p("input"),q=E(),m=p("div"),v=p("button"),k=x("Reset"),B=E(),b=p("button"),J=x("Join"),this.h()},l(u){re('[data-svelte="svelte-1rqvp1e"]',document.head).forEach(d),s=S(u),a=_(u,"DIV",{class:!0});var U=y(a);e=_(U,"FORM",{action:!0,method:!0,class:!0});var h=y(e);n=_(h,"IMG",{src:!0,alt:!0,width:!0,height:!0}),f=S(h),r=_(h,"LABEL",{for:!0,class:!0});var P=y(r);g=D(P,"Cell ID"),P.forEach(d),I=S(h),c=_(h,"INPUT",{id:!0,name:!0,type:!0,class:!0}),q=S(h),m=_(h,"DIV",{class:!0});var L=y(m);v=_(L,"BUTTON",{type:!0,class:!0});var R=y(v);k=D(R,"Reset"),R.forEach(d),B=S(L),b=_(L,"BUTTON",{type:!0,class:!0});var G=y(b);J=D(G,"Join"),G.forEach(d),L.forEach(d),h.forEach(d),U.forEach(d),this.h()},h(){document.title="New Cell | CellWall",ne(n.src,i="/logo.png")||l(n,"src",i),l(n,"alt",""),l(n,"width","48"),l(n,"height","48"),l(r,"for","control-id"),l(r,"class","svelte-1n83scs"),l(c,"id","control-id"),l(c,"name","id"),l(c,"type","text"),c.required=!0,l(c,"class","svelte-1n83scs"),l(v,"type","reset"),l(v,"class","svelte-1n83scs"),l(b,"type","submit"),l(b,"class","svelte-1n83scs"),l(m,"class","buttons svelte-1n83scs"),l(e,"action","/cell/frame/blank"),l(e,"method","get"),l(e,"class","svelte-1n83scs"),l(a,"class","fill center wrapper")},m(u,w){Y(u,s,w),Y(u,a,w),o(a,e),o(e,n),o(e,f),o(e,r),o(r,g),o(e,I),o(e,c),j(c,t[0]),o(e,q),o(e,m),o(m,v),o(v,k),o(m,B),o(m,b),o(b,J),N||(O=[F(c,"input",t[3]),F(v,"click",_e),F(e,"submit",le(t[1]))],N=!0)},p(u,[w]){w&1&&c.value!==u[0]&&j(c,u[0])},i:X,o:X,d(u){u&&d(s),u&&d(a),N=!1,oe(O)}}}const Ce=async({url:t})=>({props:{id:t.searchParams.get("id")||"",autoJoin:t.searchParams.has("autojoin")}});function _e(){localStorage.removeItem("id")}function be(t,s,a){let{id:e=""}=s,{autoJoin:n=!1}=s;ie(()=>{if(!e){const r=localStorage.getItem("id");r&&a(0,e=r)}});async function i(){localStorage.setItem("id",e),ve(),he();const r=ce(Array.from(me,g=>z(g,e)));await ue(z("BLANK",e),{replaceState:!1}),await r}function f(){e=this.value,a(0,e)}return t.$$set=r=>{"id"in r&&a(0,e=r.id),"autoJoin"in r&&a(2,n=r.autoJoin)},t.$$.update=()=>{t.$$.dirty&4&&n&&fe&&i()},[e,i,n,f]}class Ie extends te{constructor(s){super(),se(this,s,be,pe,ae,{id:0,autoJoin:2})}}export{Ie as default,Ce as load};
