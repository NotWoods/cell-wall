var de=Object.defineProperty,$e=Object.defineProperties;var ge=Object.getOwnPropertyDescriptors;var J=Object.getOwnPropertySymbols;var be=Object.prototype.hasOwnProperty,ve=Object.prototype.propertyIsEnumerable;var Q=(o,e,t)=>e in o?de(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t,X=(o,e)=>{for(var t in e||(e={}))be.call(e,t)&&Q(o,t,e[t]);if(J)for(var t of J(e))ve.call(e,t)&&Q(o,t,e[t]);return o},Z=(o,e)=>$e(o,ge(e));import{S as L,i as B,s as N,I as ae,e as w,c as y,a as T,d as h,b as p,g,J as ie,K as fe,L as ce,q as d,o as $,l as E,w as b,x as v,y as k,B as S,n as P,a4 as ue,a9 as _e,p as R,k as D,m as O,t as U,h as V,M as I,j as me,a0 as ke,Z as C,X as pe,aa as Se,V as G,Q as we,ab as Y,ac as ye,E as Te,ad as Ce,a1 as Ee,ae as Ae}from"../../chunks/index-6bece970.js";import{D as Ne,R as De}from"../../chunks/DeviceOptions-da53de79.js";import{H as W}from"../../chunks/HorizontalField-10ed728a.js";import{F as Oe}from"../../chunks/Form-1a153f1b.js";import{g as Ie,s as Le}from"../../chunks/__layout-00171295.js";import{a as Be,d as Fe,e as qe,f as ze,g as Pe,h as Re}from"../../chunks/web-1a0de502.js";import{a as je}from"../../chunks/random-ca7fbb84.js";import{l as he}from"../../chunks/index-8baee0b1.js";import{P as Me}from"../../chunks/_PowerButtons-1919d203.js";import{p as Ue}from"../../chunks/_form-52443b97.js";import"../../chunks/Label-f27fee94.js";import"../../chunks/snackbar-host-69394265.js";import"../../chunks/index-2a0b6ee6.js";import"../../chunks/TopBar-cf6a6994.js";import"../../chunks/index-82b3cc87.js";const M=[Be,Fe,qe,ze,Pe,Re],Ve=["#0F172A","#7F1D1D","#7C2D12","#78350F","#713F12","#365314","#14532D","#064E3B","#134E4A","#164E63","#0C4A6E","#1E3A8A","#312E81","#4C1D95","#581C87","#701A75","#831843","#881337"];class We{constructor(e=Ve){if(this.colors=e,e.length===0)throw new TypeError("No colors provided");this.reset()}reset(){this.unusedColors=this.colors.slice()}next(){if(this.unusedColors.length<=1){const s=this.unusedColors[0];return this.reset(),s}const e=je(this.unusedColors),t=this.unusedColors[e];return this.unusedColors.splice(e,1),t}}function He(o){let e,t;const s=o[1].default,i=ae(s,o,o[0],null);return{c(){e=w("ul"),i&&i.c(),this.h()},l(n){e=y(n,"UL",{class:!0,role:!0});var a=T(e);i&&i.l(a),a.forEach(h),this.h()},h(){p(e,"class","flex flex-wrap border-b-2 border-slate-700"),p(e,"role","tablist")},m(n,a){g(n,e,a),i&&i.m(e,null),t=!0},p(n,[a]){i&&i.p&&(!t||a&1)&&ie(i,s,n,n[0],t?ce(s,n[0],a,null):fe(n[0]),null)},i(n){t||(d(i,n),t=!0)},o(n){$(i,n),t=!1},d(n){n&&h(e),i&&i.d(n)}}}function Ke(o,e,t){let{$$slots:s={},$$scope:i}=e;return o.$$set=n=>{"$$scope"in n&&t(0,i=n.$$scope)},[i,s]}class Je extends L{constructor(e){super(),B(this,e,Ke,He,N,{})}}function x(o,e,t){const s=o.slice();return s[5]=e[t].name,s[6]=e[t].label,s[7]=e[t].type,s[8]=e[t].property,s[9]=e[t].fallback,s}function ee(o,e,t){const s=o.slice();return s[13]=e[t],s}function Qe(o){let e,t,s,i,n,a,r;return{c(){e=w("input"),this.h()},l(l){e=y(l,"INPUT",{id:!0,class:!0,name:!0,type:!0}),this.h()},h(){var l,f;p(e,"id",t="control-"+o[5]),p(e,"class",s=o[7]==="color"?"":o[12]),p(e,"name",i=o[5]),p(e,"type",n=o[7]),e.required=a=o[2].has(o[5]),e.value=r=(f=(l=o[0])==null?void 0:l[o[5]])!=null?f:o[9]},m(l,f){g(l,e,f)},p(l,f){var _,u;f&2&&t!==(t="control-"+l[5])&&p(e,"id",t),f&4098&&s!==(s=l[7]==="color"?"":l[12])&&p(e,"class",s),f&2&&i!==(i=l[5])&&p(e,"name",i),f&2&&n!==(n=l[7])&&p(e,"type",n),f&6&&a!==(a=l[2].has(l[5]))&&(e.required=a),f&3&&r!==(r=(u=(_=l[0])==null?void 0:_[l[5]])!=null?u:l[9])&&e.value!==r&&(e.value=r)},d(l){l&&h(e)}}}function Xe(o){let e,t,s,i,n=o[8].enum,a=[];for(let r=0;r<n.length;r+=1)a[r]=te(ee(o,n,r));return{c(){e=w("select");for(let r=0;r<a.length;r+=1)a[r].c();this.h()},l(r){e=y(r,"SELECT",{id:!0,name:!0,class:!0});var l=T(e);for(let f=0;f<a.length;f+=1)a[f].l(l);l.forEach(h),this.h()},h(){p(e,"id",t="control-"+o[5]),p(e,"name",s=o[5]),p(e,"class",i=o[12])},m(r,l){g(r,e,l);for(let f=0;f<a.length;f+=1)a[f].m(e,null)},p(r,l){if(l&2){n=r[8].enum;let f;for(f=0;f<n.length;f+=1){const _=ee(r,n,f);a[f]?a[f].p(_,l):(a[f]=te(_),a[f].c(),a[f].m(e,null))}for(;f<a.length;f+=1)a[f].d(1);a.length=n.length}l&2&&t!==(t="control-"+r[5])&&p(e,"id",t),l&2&&s!==(s=r[5])&&p(e,"name",s),l&4096&&i!==(i=r[12])&&p(e,"class",i)},d(r){r&&h(e),ke(a,r)}}}function te(o){let e,t=o[13]+"",s,i;return{c(){e=w("option"),s=U(t),this.h()},l(n){e=y(n,"OPTION",{});var a=T(e);s=V(a,t),a.forEach(h),this.h()},h(){e.__value=i=o[13],e.value=e.__value},m(n,a){g(n,e,a),I(e,s)},p(n,a){a&2&&t!==(t=n[13]+"")&&me(s,t),a&2&&i!==(i=n[13])&&(e.__value=i,e.value=e.__value)},d(n){n&&h(e)}}}function Ze(o){let e,t;function s(a,r){return r&2&&(e=null),e==null&&(e=!!Array.isArray(a[8].enum)),e?Xe:Qe}let i=s(o,-1),n=i(o);return{c(){n.c(),t=D()},l(a){n.l(a),t=O(a)},m(a,r){n.m(a,r),g(a,t,r)},p(a,r){i===(i=s(a,r))&&n?n.p(a,r):(n.d(1),n=i(a),n&&(n.c(),n.m(t.parentNode,t)))},d(a){n.d(a),a&&h(t)}}}function le(o,e){let t,s,i;return s=new W({props:{for:"control-"+e[5],label:e[6],$$slots:{default:[Ze,({inputClassName:n})=>({12:n}),({inputClassName:n})=>n?4096:0]},$$scope:{ctx:e}}}),{key:o,first:null,c(){t=E(),b(s.$$.fragment),this.h()},l(n){t=E(),v(s.$$.fragment,n),this.h()},h(){this.first=t},m(n,a){g(n,t,a),k(s,n,a),i=!0},p(n,a){e=n;const r={};a&2&&(r.for="control-"+e[5]),a&2&&(r.label=e[6]),a&69639&&(r.$$scope={dirty:a,ctx:e}),s.$set(r)},i(n){i||(d(s.$$.fragment,n),i=!0)},o(n){$(s.$$.fragment,n),i=!1},d(n){n&&h(t),S(s,n)}}}function Ge(o){let e=[],t=new Map,s,i,n=o[1];const a=r=>r[5];for(let r=0;r<n.length;r+=1){let l=x(o,n,r),f=a(l);t.set(f,e[r]=le(f,l))}return{c(){for(let r=0;r<e.length;r+=1)e[r].c();s=E()},l(r){for(let l=0;l<e.length;l+=1)e[l].l(r);s=E()},m(r,l){for(let f=0;f<e.length;f+=1)e[f].m(r,l);g(r,s,l),i=!0},p(r,[l]){l&4103&&(n=r[1],P(),e=ue(e,l,a,1,r,n,t,s.parentNode,_e,le,s,x),R())},i(r){if(!i){for(let l=0;l<n.length;l+=1)d(e[l]);i=!0}},o(r){for(let l=0;l<e.length;l+=1)$(e[l]);i=!1},d(r){for(let l=0;l<e.length;l+=1)e[l].d(r);r&&h(s)}}}function Ye(o,e){if(Array.isArray(e.enum))return"select";if(o.endsWith("Color"))return"color";switch(e.type){case"number":return"number";case"string":if(e.format==="uri")return"url";default:return"text"}}function xe(o,e,t){let s,i;const n=new We;let{schema:a}=e,{state:r=void 0}=e;return o.$$set=l=>{"schema"in l&&t(3,a=l.schema),"state"in l&&t(0,r=l.state)},o.$$.update=()=>{o.$$.dirty&8&&t(2,s=new Set((a==null?void 0:a.required)||[])),o.$$.dirty&8&&t(1,i=Object.entries((a==null?void 0:a.properties)||{}).filter(([l])=>l!=="type").map(([l,f])=>{var u;const _=Ye(l,f);return{name:l,label:(u=f.title)!=null?u:he(l),property:f,type:_,fallback:_==="color"?n.next():""}}))},[r,i,s,a]}class et extends L{constructor(e){super(),B(this,e,xe,Ge,N,{schema:3,state:0})}}function tt(o){let e,t,s,i,n;const a=o[3].default,r=ae(a,o,o[2],null);return{c(){e=w("li"),t=w("button"),r&&r.c(),this.h()},l(l){e=y(l,"LI",{class:!0});var f=T(e);t=y(f,"BUTTON",{type:!0,class:!0,role:!0,"aria-selected":!0,"aria-controls":!0});var _=T(t);r&&r.l(_),_.forEach(h),f.forEach(h),this.h()},h(){p(t,"type","button"),p(t,"class","border-b-2 -mb-[2px] px-4 py-2 transition-colors"),p(t,"role","tab"),p(t,"aria-selected",o[0]),p(t,"aria-controls",o[1]),C(t,"text-green-400",o[0]),C(t,"border-current",o[0]),C(t,"border-transparent",!o[0]),C(t,"hover:border-white",!o[0]),p(e,"class","inline-block")},m(l,f){g(l,e,f),I(e,t),r&&r.m(t,null),s=!0,i||(n=pe(t,"click",o[4]),i=!0)},p(l,[f]){r&&r.p&&(!s||f&4)&&ie(r,a,l,l[2],s?ce(a,l[2],f,null):fe(l[2]),null),(!s||f&1)&&p(t,"aria-selected",l[0]),(!s||f&2)&&p(t,"aria-controls",l[1]),f&1&&C(t,"text-green-400",l[0]),f&1&&C(t,"border-current",l[0]),f&1&&C(t,"border-transparent",!l[0]),f&1&&C(t,"hover:border-white",!l[0])},i(l){s||(d(r,l),s=!0)},o(l){$(r,l),s=!1},d(l){l&&h(e),r&&r.d(l),i=!1,n()}}}function lt(o,e,t){let{$$slots:s={},$$scope:i}=e,{selected:n=!1}=e,{controls:a}=e;function r(l){Se.call(this,o,l)}return o.$$set=l=>{"selected"in l&&t(0,n=l.selected),"controls"in l&&t(1,a=l.controls),"$$scope"in l&&t(2,i=l.$$scope)},[n,a,i,s,r]}class st extends L{constructor(e){super(),B(this,e,lt,tt,N,{selected:0,controls:1})}}function rt(o){let e;return{c(){e=U(o[2])},l(t){e=V(t,o[2])},m(t,s){g(t,e,s)},p(t,s){s&4&&me(e,t[2])},d(t){t&&h(e)}}}function nt(o){let e,t;return e=new st({props:{selected:o[1]===o[0],controls:"custom-form",$$slots:{default:[rt]},$$scope:{ctx:o}}}),e.$on("click",o[4]),{c(){b(e.$$.fragment)},l(s){v(e.$$.fragment,s)},m(s,i){k(e,s,i),t=!0},p(s,[i]){const n={};i&3&&(n.selected=s[1]===s[0]),i&36&&(n.$$scope={dirty:i,ctx:s}),e.$set(n)},i(s){t||(d(e.$$.fragment,s),t=!0)},o(s){$(e.$$.fragment,s),t=!1},d(s){S(e,s)}}}function ot(o,e,t){let s,i,{selectedType:n}=e,{schema:a}=e;const r=()=>{t(0,n=s)};return o.$$set=l=>{"selectedType"in l&&t(0,n=l.selectedType),"schema"in l&&t(3,a=l.schema)},o.$$.update=()=>{o.$$.dirty&8&&t(1,s=a.properties.type.const),o.$$.dirty&2&&t(2,i=he(s.toLocaleLowerCase()))},[n,s,i,a,r]}class at extends L{constructor(e){super(),B(this,e,ot,nt,N,{selectedType:0,schema:3})}}function se(o,e,t){const s=o.slice();return s[13]=e[t],s}function it(o){let e,t,s,i,n,a,r,l;return i=new Ne({props:{devices:o[4]}}),{c(){e=w("select"),t=w("option"),s=U("All devices"),b(i.$$.fragment),this.h()},l(f){e=y(f,"SELECT",{class:!0,id:!0,form:!0});var _=T(e);t=y(_,"OPTION",{});var u=T(t);s=V(u,"All devices"),u.forEach(h),v(i.$$.fragment,_),_.forEach(h),this.h()},h(){t.__value="",t.value=t.__value,p(e,"class",n=o[16]+" cursor-pointer"),p(e,"id","control-serial"),p(e,"form","custom-form"),o[1]===void 0&&we(()=>o[10].call(e))},m(f,_){g(f,e,_),I(e,t),I(t,s),k(i,e,null),Y(e,o[1]),a=!0,r||(l=pe(e,"change",o[10]),r=!0)},p(f,_){const u={};_&16&&(u.devices=f[4]),i.$set(u),(!a||_&65536&&n!==(n=f[16]+" cursor-pointer"))&&p(e,"class",n),_&2&&Y(e,f[1])},i(f){a||(d(i.$$.fragment,f),a=!0)},o(f){$(i.$$.fragment,f),a=!1},d(f){f&&h(e),S(i),r=!1,l()}}}function re(o){let e,t;return e=new W({props:{label:"Power",$$slots:{default:[ft]},$$scope:{ctx:o}}}),{c(){b(e.$$.fragment)},l(s){v(e.$$.fragment,s)},m(s,i){k(e,s,i),t=!0},p(s,i){const n={};i&131074&&(n.$$scope={dirty:i,ctx:s}),e.$set(n)},i(s){t||(d(e.$$.fragment,s),t=!0)},o(s){$(e.$$.fragment,s),t=!1},d(s){S(e,s)}}}function ft(o){let e,t;return e=new Me({props:{serial:o[1]}}),{c(){b(e.$$.fragment)},l(s){v(e.$$.fragment,s)},m(s,i){k(e,s,i),t=!0},p(s,i){const n={};i&2&&(n.serial=s[1]),e.$set(n)},i(s){t||(d(e.$$.fragment,s),t=!0)},o(s){$(e.$$.fragment,s),t=!1},d(s){S(e,s)}}}function ne(o,e){let t,s,i,n;function a(l){e[11](l)}let r={schema:e[13]};return e[0]!==void 0&&(r.selectedType=e[0]),s=new at({props:r}),Ee.push(()=>Ae(s,"selectedType",a)),{key:o,first:null,c(){t=E(),b(s.$$.fragment),this.h()},l(l){t=E(),v(s.$$.fragment,l),this.h()},h(){this.first=t},m(l,f){g(l,t,f),k(s,l,f),n=!0},p(l,f){e=l;const _={};!i&&f&1&&(i=!0,_.selectedType=e[0],ye(()=>i=!1)),s.$set(_)},i(l){n||(d(s.$$.fragment,l),n=!0)},o(l){$(s.$$.fragment,l),n=!1},d(l){l&&h(t),S(s,l)}}}function ct(o){let e=[],t=new Map,s,i,n=M;const a=r=>r[13].properties.type.const;for(let r=0;r<n.length;r+=1){let l=se(o,n,r),f=a(l);t.set(f,e[r]=ne(f,l))}return{c(){for(let r=0;r<e.length;r+=1)e[r].c();s=E()},l(r){for(let l=0;l<e.length;l+=1)e[l].l(r);s=E()},m(r,l){for(let f=0;f<e.length;f+=1)e[f].m(r,l);g(r,s,l),i=!0},p(r,l){l&1&&(n=M,P(),e=ue(e,l,a,1,r,n,t,s.parentNode,_e,ne,s,se),R())},i(r){if(!i){for(let l=0;l<n.length;l+=1)d(e[l]);i=!0}},o(r){for(let l=0;l<e.length;l+=1)$(e[l]);i=!1},d(r){for(let l=0;l<e.length;l+=1)e[l].d(r);r&&h(s)}}}function oe(o){var s;let e,t;return e=new et({props:{schema:o[2],state:(s=o[3])==null?void 0:s.state}}),{c(){b(e.$$.fragment)},l(i){v(e.$$.fragment,i)},m(i,n){k(e,i,n),t=!0},p(i,n){var r;const a={};n&4&&(a.schema=i[2]),n&8&&(a.state=(r=i[3])==null?void 0:r.state),e.$set(a)},i(i){t||(d(e.$$.fragment,i),t=!0)},o(i){$(e.$$.fragment,i),t=!1},d(i){S(e,i)}}}function ut(o){let e=o[0],t,s,i,n=oe(o);return s=new De({props:{loading:o[12]}}),{c(){n.c(),t=D(),b(s.$$.fragment)},l(a){n.l(a),t=O(a),v(s.$$.fragment,a)},m(a,r){n.m(a,r),g(a,t,r),k(s,a,r),i=!0},p(a,r){r&1&&N(e,e=a[0])?(P(),$(n,1,1,Te),R(),n=oe(a),n.c(),d(n,1),n.m(t.parentNode,t)):n.p(a,r);const l={};r&4096&&(l.loading=a[12]),s.$set(l)},i(a){i||(d(n),d(s.$$.fragment,a),i=!0)},o(a){$(n),$(s.$$.fragment,a),i=!1},d(a){n.d(a),a&&h(t),S(s,a)}}}function _t(o){var F,q;let e,t,s,i=!o[3]||((q=(F=o[3])==null?void 0:F.connection)==null?void 0:q.includes("android")),n,a,r,l,f,_;t=new W({props:{for:"control-serial",label:"Device",$$slots:{default:[it,({inputClassName:c})=>({16:c}),({inputClassName:c})=>c?65536:0]},$$scope:{ctx:o}}});let u=i&&re(o);return r=new Je({props:{$$slots:{default:[ct]},$$scope:{ctx:o}}}),f=new Oe({props:{id:"custom-form",class:"flex flex-col gap-y-4 px-2",role:"tabpanel",action:"/api/device/state/"+o[1],onSubmit:o[7],$$slots:{default:[ut,({loading:c})=>({12:c}),({loading:c})=>c?4096:0]},$$scope:{ctx:o}}}),{c(){e=w("div"),b(t.$$.fragment),s=D(),u&&u.c(),n=D(),a=w("nav"),b(r.$$.fragment),l=D(),b(f.$$.fragment),this.h()},l(c){e=y(c,"DIV",{class:!0});var m=T(e);v(t.$$.fragment,m),s=O(m),u&&u.l(m),m.forEach(h),n=O(c),a=y(c,"NAV",{class:!0});var A=T(a);v(r.$$.fragment,A),A.forEach(h),l=O(c),v(f.$$.fragment,c),this.h()},h(){p(e,"class","flex flex-col gap-y-4 px-2 mb-4"),p(a,"class","mb-6")},m(c,m){g(c,e,m),k(t,e,null),I(e,s),u&&u.m(e,null),g(c,n,m),g(c,a,m),k(r,a,null),g(c,l,m),k(f,c,m),_=!0},p(c,[m]){var H,K;const A={};m&196626&&(A.$$scope={dirty:m,ctx:c}),t.$set(A),m&8&&(i=!c[3]||((K=(H=c[3])==null?void 0:H.connection)==null?void 0:K.includes("android"))),i?u?(u.p(c,m),m&8&&d(u,1)):(u=re(c),u.c(),d(u,1),u.m(e,null)):u&&(P(),$(u,1,1,()=>{u=null}),R());const z={};m&131073&&(z.$$scope={dirty:m,ctx:c}),r.$set(z);const j={};m&2&&(j.action="/api/device/state/"+c[1]),m&135181&&(j.$$scope={dirty:m,ctx:c}),f.$set(j)},i(c){_||(d(t.$$.fragment,c),d(u),d(r.$$.fragment,c),d(f.$$.fragment,c),_=!0)},o(c){$(t.$$.fragment,c),$(u),$(r.$$.fragment,c),$(f.$$.fragment,c),_=!1},d(c){c&&h(e),S(t),u&&u.d(),c&&h(n),c&&h(a),S(r),c&&h(l),S(f,c)}}}const Dt=async({url:o})=>({props:{defaultSerial:o.searchParams.get("id")||""}});function mt(o,e,t){let s,i,n,a,{defaultSerial:r}=e;const{state:l}=Ie();G(o,l,m=>t(9,n=m));const f=Le(l);G(o,f,m=>t(4,a=m));let _="BLANK",u=r||"";async function F(m,A){const z=Object.fromEntries(m);await Ue(A.toString(),Z(X({},z),{type:_}))}function q(){u=Ce(this),t(1,u),t(8,r)}function c(m){_=m,t(0,_)}return o.$$set=m=>{"defaultSerial"in m&&t(8,r=m.defaultSerial)},o.$$.update=()=>{o.$$.dirty&256&&t(1,u=r),o.$$.dirty&514&&t(3,s=n.get(u)),o.$$.dirty&1&&t(2,i=M.find(m=>m.properties.type.const===_))},[_,u,i,s,a,l,f,F,r,n,q,c]}class Ot extends L{constructor(e){super(),B(this,e,mt,_t,N,{defaultSerial:8})}}export{Ot as default,Dt as load};
