import{S as D,i as V,s as H,w as d,x as g,y as b,q as p,o as _,B as v,L,k,m as w,g as h,d as m,e as x,c as E,a as B,b as u,l as z,ae as F,n as P,a6 as I,a7 as M,p as N}from"../../chunks/vendor-e399076d.js";import{R as O}from"../../chunks/ResetSubmit-91d58d6b.js";import{D as U}from"../../chunks/DeviceOption-8cf67013.js";import{H as R}from"../../chunks/HorizontalField-e9e4ce0a.js";import{V as X}from"../../chunks/VerticalField-1b909771.js";import{F as j}from"../../chunks/SubmitButton-4475d829.js";import{a as G,s as J}from"../../chunks/__layout-b3bcd805.js";import"../../chunks/LoadingSpinner-1dda806c.js";import"../../chunks/snackbar-host-7b34ee00.js";import"../../chunks/cell-state-schema-b294815b.js";import"../../chunks/TopBar-bec206db.js";function q(l,t,o){const r=l.slice();return r[5]=t[o],r}function K(l){let t,o;return{c(){t=x("textarea"),this.h()},l(r){t=E(r,"TEXTAREA",{class:!0,id:!0,name:!0,rows:!0,placeholder:!0}),B(t).forEach(m),this.h()},h(){u(t,"class",o=l[4]),t.required=!0,u(t,"id","control-text"),u(t,"name","text"),u(t,"rows","10"),u(t,"placeholder"," Apple \r Banana \r Carrot")},m(r,n){h(r,t,n)},p(r,n){n&16&&o!==(o=r[4])&&u(t,"class",o)},d(r){r&&m(t)}}}function Q(l){let t;return{c(){t=x("input"),this.h()},l(o){t=E(o,"INPUT",{id:!0,name:!0,type:!0}),this.h()},h(){u(t,"id","control-color"),u(t,"name","backgroundColor"),u(t,"type","color"),t.value="#ffffff"},m(o,r){h(o,t,r)},d(o){o&&m(t)}}}function A(l,t){let o,r,n;return r=new U({props:{device:t[5]}}),{key:l,first:null,c(){o=z(),d(r.$$.fragment),this.h()},l(a){o=z(),g(r.$$.fragment,a),this.h()},h(){this.first=o},m(a,i){h(a,o,i),b(r,a,i),n=!0},p(a,i){t=a;const f={};i&1&&(f.device=t[5]),r.$set(f)},i(a){n||(p(r.$$.fragment,a),n=!0)},o(a){_(r.$$.fragment,a),n=!1},d(a){a&&m(o),v(r,a)}}}function W(l){let t,o=[],r=new Map,n,a,i,f=l[0];const $=e=>e[5].serial;for(let e=0;e<f.length;e+=1){let s=q(l,f,e),c=$(s);r.set(c,o[e]=A(c,s))}return{c(){t=x("select");for(let e=0;e<o.length;e+=1)o[e].c();this.h()},l(e){t=E(e,"SELECT",{name:!0,id:!0,class:!0});var s=B(t);for(let c=0;c<o.length;c+=1)o[c].l(s);s.forEach(m),this.h()},h(){t.multiple=!0,u(t,"name","device"),u(t,"id","control-serial"),u(t,"class",n=l[4])},m(e,s){h(e,t,s);for(let c=0;c<o.length;c+=1)o[c].m(t,null);F(t,l[0].map(C)),i=!0},p(e,s){s&1&&(f=e[0],P(),o=I(o,s,$,1,e,f,r,t,M,A,null,q),N()),(!i||s&16&&n!==(n=e[4]))&&u(t,"class",n),(!i||s&1&&a!==(a=e[0].map(C)))&&F(t,e[0].map(C))},i(e){if(!i){for(let s=0;s<f.length;s+=1)p(o[s]);i=!0}},o(e){for(let s=0;s<o.length;s+=1)_(o[s]);i=!1},d(e){e&&m(t);for(let s=0;s<o.length;s+=1)o[s].d()}}}function Y(l){let t,o,r,n,a,i,f,$;return t=new X({props:{for:"control-text",label:"Text",$$slots:{default:[K,({inputClassName:e})=>({4:e}),({inputClassName:e})=>e?16:0]},$$scope:{ctx:l}}}),r=new R({props:{for:"control-color",label:"Background Color",$$slots:{default:[Q]},$$scope:{ctx:l}}}),a=new R({props:{for:"control-serial",label:"Devices",$$slots:{default:[W,({inputClassName:e})=>({4:e}),({inputClassName:e})=>e?16:0]},$$scope:{ctx:l}}}),f=new O({props:{loading:l[3]}}),{c(){d(t.$$.fragment),o=k(),d(r.$$.fragment),n=k(),d(a.$$.fragment),i=k(),d(f.$$.fragment)},l(e){g(t.$$.fragment,e),o=w(e),g(r.$$.fragment,e),n=w(e),g(a.$$.fragment,e),i=w(e),g(f.$$.fragment,e)},m(e,s){b(t,e,s),h(e,o,s),b(r,e,s),h(e,n,s),b(a,e,s),h(e,i,s),b(f,e,s),$=!0},p(e,s){const c={};s&272&&(c.$$scope={dirty:s,ctx:e}),t.$set(c);const S={};s&256&&(S.$$scope={dirty:s,ctx:e}),r.$set(S);const T={};s&273&&(T.$$scope={dirty:s,ctx:e}),a.$set(T);const y={};s&8&&(y.loading=e[3]),f.$set(y)},i(e){$||(p(t.$$.fragment,e),p(r.$$.fragment,e),p(a.$$.fragment,e),p(f.$$.fragment,e),$=!0)},o(e){_(t.$$.fragment,e),_(r.$$.fragment,e),_(a.$$.fragment,e),_(f.$$.fragment,e),$=!1},d(e){v(t,e),e&&m(o),v(r,e),e&&m(n),v(a,e),e&&m(i),v(f,e)}}}function Z(l){let t,o;return t=new j({props:{class:"flex flex-col gap-y-4",action:"/api/action/text",onSubmit:ee,$$slots:{default:[Y,({loading:r})=>({3:r}),({loading:r})=>r?8:0]},$$scope:{ctx:l}}}),{c(){d(t.$$.fragment)},l(r){g(t.$$.fragment,r)},m(r,n){b(t,r,n),o=!0},p(r,[n]){const a={};n&265&&(a.$$scope={dirty:n,ctx:r}),t.$set(a)},i(r){o||(p(t.$$.fragment,r),o=!0)},o(r){_(t.$$.fragment,r),o=!1},d(r){v(t,r)}}}const $e=!0;async function ee(l,t){const o=l.get("backgroundColor");o!=="#ffffff"&&t.searchParams.set("backgroundColor",o);try{const r=await fetch(t.toString(),{method:"post",headers:{"content-type":"text/plain"},body:l.get("text")});if(!r.ok)throw new Error(r.statusText)}catch(r){throw console.error(r),r}}const C=l=>l.serial;function te(l,t,o){let r;const{state:n}=G(),a=J(n);return L(l,a,i=>o(0,r=i)),[r,a]}class pe extends D{constructor(t){super();V(this,t,te,Z,H,{})}}export{pe as default,$e as prerender};
