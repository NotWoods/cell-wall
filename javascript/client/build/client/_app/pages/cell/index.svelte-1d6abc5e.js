var Y=Object.defineProperty,$=Object.defineProperties;var ee=Object.getOwnPropertyDescriptors;var I=Object.getOwnPropertySymbols;var W=Object.prototype.hasOwnProperty,j=Object.prototype.propertyIsEnumerable;var G=(t,s,a)=>s in t?Y(t,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[s]=a,x=(t,s)=>{for(var a in s||(s={}))W.call(s,a)&&G(t,a,s[a]);if(I)for(var a of I(s))j.call(s,a)&&G(t,a,s[a]);return t},A=(t,s)=>$(t,ee(s));var B=(t,s)=>{var a={};for(var e in t)W.call(t,e)&&s.indexOf(e)<0&&(a[e]=t[e]);if(t!=null&&I)for(var e of I(t))s.indexOf(e)<0&&j.call(t,e)&&(a[e]=t[e]);return a};import{S as te,i as se,s as ae,k as E,e as p,t as D,N as re,d,m as S,c as _,a as y,h as F,X as ne,b as l,g as K,M as o,Z as X,T as M,_ as le,E as Z,G as oe,v as ie}from"../../chunks/index-36754a35.js";import{p as ce,f as z,g as ue}from"../../chunks/state-socket-790a3ce2.js";import{d as H,w as de}from"../../chunks/index-2d3b577e.js";import"../../chunks/web-9961d8d9.js";import{c as fe}from"../../chunks/index-cc0f756b.js";import"../../chunks/singletons-d1fb5791.js";const me=!0;function Q(){const t=de({active:!1});return{state:t,active:H(t,s=>s.active),error:H(t,s=>s.error)}}function ve(){const t=new AbortController,n=Q(),{state:s}=n,a=B(n,["state"]);async function e(){try{await document.documentElement.requestFullscreen().then(()=>s.set({active:!0}),i=>s.set({active:!1,error:i})),s.set({active:!0})}catch(i){if(i instanceof Error)s.set({active:!1,error:i});else throw i}}return e(),document.addEventListener("fullscreenchange",()=>{s.set({active:Boolean(document.fullscreenElement)})},t),A(x({},a),{async release(){t.abort(),await document.exitFullscreen()}})}function he(){if("wakeLock"in navigator){let s=function(){e!==null&&document.visibilityState==="visible"&&f()};const a=new AbortController;let e;const t=Q(),{state:n}=t,i=B(t,["state"]);async function f(){try{e=await navigator.wakeLock.request("screen"),n.set({active:!0}),e.addEventListener("release",()=>{n.set({active:!1})},a)}catch(r){if(r instanceof DOMException)n.set({active:!1,error:r});else throw r}}return f(),document.addEventListener("visibilitychange",s,a),document.addEventListener("fullscreenchange",s,a),A(x({},i),{async release(){a.abort(),await(e==null?void 0:e.release())}})}else return}function pe(t){let s,a,e,n,i,f,r,g,L,c,k,m,v,C,J,b,N,T,O;return{c(){s=E(),a=p("div"),e=p("form"),n=p("img"),f=E(),r=p("label"),g=D("Cell ID"),L=E(),c=p("input"),k=E(),m=p("div"),v=p("button"),C=D("Reset"),J=E(),b=p("button"),N=D("Join"),this.h()},l(u){re('[data-svelte="svelte-1rqvp1e"]',document.head).forEach(d),s=S(u),a=_(u,"DIV",{class:!0});var P=y(a);e=_(P,"FORM",{action:!0,method:!0,class:!0});var h=y(e);n=_(h,"IMG",{src:!0,alt:!0,width:!0,height:!0}),f=S(h),r=_(h,"LABEL",{for:!0,class:!0});var R=y(r);g=F(R,"Cell ID"),R.forEach(d),L=S(h),c=_(h,"INPUT",{id:!0,name:!0,type:!0,class:!0}),k=S(h),m=_(h,"DIV",{class:!0});var q=y(m);v=_(q,"BUTTON",{type:!0,class:!0});var U=y(v);C=F(U,"Reset"),U.forEach(d),J=S(q),b=_(q,"BUTTON",{type:!0,class:!0});var V=y(b);N=F(V,"Join"),V.forEach(d),q.forEach(d),h.forEach(d),P.forEach(d),this.h()},h(){document.title="New Cell | CellWall",ne(n.src,i="/logo.png")||l(n,"src",i),l(n,"alt",""),l(n,"width","48"),l(n,"height","48"),l(r,"for","control-id"),l(r,"class","svelte-1n83scs"),l(c,"id","control-id"),l(c,"name","id"),l(c,"type","text"),c.required=!0,l(c,"class","svelte-1n83scs"),l(v,"type","reset"),l(v,"class","svelte-1n83scs"),l(b,"type","submit"),l(b,"class","svelte-1n83scs"),l(m,"class","buttons svelte-1n83scs"),l(e,"action","/cell/frame/blank"),l(e,"method","get"),l(e,"class","svelte-1n83scs"),l(a,"class","fill center wrapper")},m(u,w){K(u,s,w),K(u,a,w),o(a,e),o(e,n),o(e,f),o(e,r),o(r,g),o(e,L),o(e,c),X(c,t[0]),o(e,k),o(e,m),o(m,v),o(v,C),o(m,J),o(m,b),o(b,N),T||(O=[M(c,"input",t[3]),M(v,"click",_e),M(e,"submit",le(t[1]))],T=!0)},p(u,[w]){w&1&&c.value!==u[0]&&X(c,u[0])},i:Z,o:Z,d(u){u&&d(s),u&&d(a),T=!1,oe(O)}}}const Le=async({url:t})=>({props:{id:t.searchParams.get("id")||"",autoJoin:t.searchParams.has("autojoin")}});function _e(){localStorage.removeItem("id")}function be(t,s,a){let{id:e=""}=s,{autoJoin:n=!1}=s;ie(()=>{if(!e){const r=localStorage.getItem("id");r&&a(0,e=r)}});async function i(){localStorage.setItem("id",e),ve(),he();const r=ce(Array.from(fe,g=>z(g,e)));await ue(z("BLANK",e),{replaceState:!1}),await r}function f(){e=this.value,a(0,e)}return t.$$set=r=>{"id"in r&&a(0,e=r.id),"autoJoin"in r&&a(2,n=r.autoJoin)},t.$$.update=()=>{t.$$.dirty&4&&n&&me&&i()},[e,i,n,f]}class ke extends te{constructor(s){super(),se(this,s,be,pe,ae,{id:0,autoJoin:2})}}export{ke as default,Le as load};
