var Y=Object.defineProperty,$=Object.defineProperties;var ee=Object.getOwnPropertyDescriptors;var q=Object.getOwnPropertySymbols;var K=Object.prototype.hasOwnProperty,W=Object.prototype.propertyIsEnumerable;var j=(t,s,a)=>s in t?Y(t,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[s]=a,T=(t,s)=>{for(var a in s||(s={}))K.call(s,a)&&j(t,a,s[a]);if(q)for(var a of q(s))W.call(s,a)&&j(t,a,s[a]);return t},x=(t,s)=>$(t,ee(s));var A=(t,s)=>{var a={};for(var e in t)K.call(t,e)&&s.indexOf(e)<0&&(a[e]=t[e]);if(t!=null&&q)for(var e of q(t))s.indexOf(e)<0&&W.call(t,e)&&(a[e]=t[e]);return a};import{V as G,D as te,S as se,i as ae,s as re,k as E,e as p,t as B,X as ne,d,m as S,c as _,a as y,h as F,Z as le,b as l,g as X,J as o,aj as Z,O,$ as oe,K as z,ak as ie,v as ce}from"../../chunks/vendor-92048905.js";import{p as ue,f as H,g as de}from"../../chunks/state-socket-bd1aeee5.js";import"../../chunks/cell-state-schema-a24ecc56.js";import{c as fe}from"../../chunks/index-60355bff.js";import"../../chunks/singletons-d1fb5791.js";const me=!0;function Q(){const t=te({active:!1});return{state:t,active:G(t,s=>s.active),error:G(t,s=>s.error)}}function ve(){const t=new AbortController,n=Q(),{state:s}=n,a=A(n,["state"]);async function e(){try{await document.documentElement.requestFullscreen().then(()=>s.set({active:!0}),i=>s.set({active:!1,error:i})),s.set({active:!0})}catch(i){if(i instanceof Error)s.set({active:!1,error:i});else throw i}}return e(),document.addEventListener("fullscreenchange",()=>{s.set({active:Boolean(document.fullscreenElement)})},t),x(T({},a),{async release(){t.abort(),await document.exitFullscreen()}})}function he(){if("wakeLock"in navigator){let s=function(){e!==null&&document.visibilityState==="visible"&&f()};const a=new AbortController;let e;const t=Q(),{state:n}=t,i=A(t,["state"]);async function f(){try{e=await navigator.wakeLock.request("screen"),n.set({active:!0}),e.addEventListener("release",()=>{n.set({active:!1})},a)}catch(r){if(r instanceof DOMException)n.set({active:!1,error:r});else throw r}}return f(),document.addEventListener("visibilitychange",s,a),document.addEventListener("fullscreenchange",s,a),x(T({},i),{async release(){a.abort(),await(e==null?void 0:e.release())}})}else return}function pe(t){let s,a,e,n,i,f,r,g,I,c,L,m,v,C,J,b,D,N,M;return{c(){s=E(),a=p("div"),e=p("form"),n=p("img"),f=E(),r=p("label"),g=B("Cell ID"),I=E(),c=p("input"),L=E(),m=p("div"),v=p("button"),C=B("Reset"),J=E(),b=p("button"),D=B("Join"),this.h()},l(u){ne('[data-svelte="svelte-1rqvp1e"]',document.head).forEach(d),s=S(u),a=_(u,"DIV",{class:!0});var P=y(a);e=_(P,"FORM",{action:!0,method:!0,class:!0});var h=y(e);n=_(h,"IMG",{src:!0,alt:!0,width:!0,height:!0}),f=S(h),r=_(h,"LABEL",{for:!0,class:!0});var R=y(r);g=F(R,"Cell ID"),R.forEach(d),I=S(h),c=_(h,"INPUT",{id:!0,name:!0,type:!0,class:!0}),L=S(h),m=_(h,"DIV",{class:!0});var k=y(m);v=_(k,"BUTTON",{type:!0,class:!0});var U=y(v);C=F(U,"Reset"),U.forEach(d),J=S(k),b=_(k,"BUTTON",{type:!0,class:!0});var V=y(b);D=F(V,"Join"),V.forEach(d),k.forEach(d),h.forEach(d),P.forEach(d),this.h()},h(){document.title="New Cell | CellWall",le(n.src,i="/logo.png")||l(n,"src",i),l(n,"alt",""),l(n,"width","48"),l(n,"height","48"),l(r,"for","control-id"),l(r,"class","svelte-1n83scs"),l(c,"id","control-id"),l(c,"name","id"),l(c,"type","text"),c.required=!0,l(c,"class","svelte-1n83scs"),l(v,"type","reset"),l(v,"class","svelte-1n83scs"),l(b,"type","submit"),l(b,"class","svelte-1n83scs"),l(m,"class","buttons svelte-1n83scs"),l(e,"action","/cell/frame/blank"),l(e,"method","get"),l(e,"class","svelte-1n83scs"),l(a,"class","fill center wrapper")},m(u,w){X(u,s,w),X(u,a,w),o(a,e),o(e,n),o(e,f),o(e,r),o(r,g),o(e,I),o(e,c),Z(c,t[0]),o(e,L),o(e,m),o(m,v),o(v,C),o(m,J),o(m,b),o(b,D),N||(M=[O(c,"input",t[3]),O(v,"click",_e),O(e,"submit",oe(t[1]))],N=!0)},p(u,[w]){w&1&&c.value!==u[0]&&Z(c,u[0])},i:z,o:z,d(u){u&&d(s),u&&d(a),N=!1,ie(M)}}}const qe=async({url:t})=>({props:{id:t.searchParams.get("id")||"",autoJoin:t.searchParams.has("autojoin")}});function _e(){localStorage.removeItem("id")}function be(t,s,a){let{id:e=""}=s,{autoJoin:n=!1}=s;ce(()=>{if(!e){const r=localStorage.getItem("id");r&&a(0,e=r)}});async function i(){localStorage.setItem("id",e),ve(),he();const r=ue(Array.from(fe,g=>H(g,e)));await de(H("BLANK",e),{replaceState:!1}),await r}function f(){e=this.value,a(0,e)}return t.$$set=r=>{"id"in r&&a(0,e=r.id),"autoJoin"in r&&a(2,n=r.autoJoin)},t.$$.update=()=>{t.$$.dirty&4&&n&&me&&i()},[e,i,n,f]}class Ie extends se{constructor(s){super();ae(this,s,be,pe,re,{id:0,autoJoin:2})}}export{Ie as default,qe as load};
